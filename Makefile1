# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile1                                          :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: matislessardgrenier <matislessardgrenie    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2024/09/29 04:07:08 by ccodere           #+#    #+#              #
#    Updated: 2024/10/08 12:56:54 by matislessar      ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

CC = gcc

RL_DIR 			=	readline
RL_H			=	libhistory.a
RL_L			=	libreadline.a

RL_LIB = -L$(RL_DIR)

CFLAGS = -Wall -Werror -Wextra

RLFLAGS = $(RL_LIB)

NAME = minishell

LIBFT_DIR = libft

LIBFT = $(LIBFT_DIR)/libft.a

CMD = commands

SRC = minishell.c ft_exit.c ft_utils.c redirection.c ft_init_tokens.c ft_if_is.c

SRC += $(CMD)/ft_check_cmd_path.c $(CMD)/ft_commands.c $(CMD)/cd.c $(CMD)/pwd.c \
	   $(CMD)/echo.c

OBJS = $(SRC:.c=.o)

all: $(LIBFT) $(NAME)

$(LIBFT):
	$(MAKE) -C $(LIBFT_DIR) all

$(NAME): $(OBJS)
	$(CC) $(CFLAGS) $(OBJS) $(LIBFT) $(RL_LIB) -I minishell.h -L include/readline -l readline -l ncurses \
	$(RL_DIR)/$(RL_H) $(RL_DIR)/$(RL_L) -o $(NAME)

%.o: %.c 
	$(CC) $(CFLAGS) -c $< -o $@

readline:
	cd readline && ./configure && $(MAKE)

rm_readline:
	cd readline && make distclean

config:
	cp .config/.msrc $$HOME

rm_config:
	rm $$HOME/.msrc

clean:
	rm -f $(OBJS)
	$(MAKE) -C $(LIBFT_DIR) fclean

fclean: clean
	rm -f $(NAME)
	$(MAKE) -C $(LIBFT_DIR) fclean

re: fclean all

exp:
	echo export CPPFLAGS="-I/opt/homebrew/opt/readline/include"
	echo export LDFLAGS="-L/opt/homebrew/opt/readline/lib"

.PHONY: all clean fclean re
